name: Deploy Seraphim.Data

on:
  workflow_dispatch:
  push:
    branches:
      - main

env:
  ENVIRONMENT: dev
  WEB_APP_NAME: srphm-data-usce-as-dev
  DOMAIN: Data

jobs:
  build:
    uses: SeraphGuild/Seraphim/.github/workflows/buildimage.yaml@main
    with:
      DOMAIN: ${{ env.DOMAIN }}
      WEB_APP_NAME: ${{ env.WEB_APP_NAME }}
  # deploy:
  #   needs: build
  #   uses: SeraphGuild/Seraphim/.github/workflows/deployimage.yaml@main
  #   with:
  #     WEB_APP_NAME: ${{ env.WEB_APP_NAME }}
  #     ENVIRONMENT: ${{ env.ENVIRONMENT }}
  configure:
    # needs: deploy
    uses: SeraphGuild/Seraphim/.github/workflows/configurewebapp.yaml@main
    with:
      WEB_APP_NAME: ${{ env.WEB_APP_NAME }}
      ENVIRONMENT: ${{ env.ENVIRONMENT }}
    secrets:
      appSettings: ${{ secrets.DATA_APP_SETTINGS }}